{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.2.js"],"names":["NegociacaoController","$","document","querySelector","bind","_data","_quantidade","_valor","_negociacoesView","NegociacoesView","_listaNegociacoes","Bind","ListaNegociacoes","_mensagemView","MensagemView","_mensagem","Mensagem","event","preventDefault","negociacao","_criaNegociacao","addNegociacao","setTexto","_updateNegociacaoView","_limpaFormulario","deletaNegociacoes","service","NegociacaoService","Promise","all","obterNegociacoesDaSemana","obterNegociacoesDaSemanaRetrasada","obterNegociacoesDaSemanaAnterior","then","result","forEach","negociacaoList","catch","erro","Negociacao","DateHelper","convertStringToData","value","focus","listaNegociacoes","mensagem","update"],"mappings":";;;;;;IAAMA,oB;AAEF,oCAAc;AAAA;;AACV,YAAIC,IAAIC,SAASC,aAAT,CAAuBC,IAAvB,CAA4BF,QAA5B,CAAR;AACA,aAAKG,KAAL,GAAaJ,EAAE,OAAF,CAAb;AACA,aAAKK,WAAL,GAAmBL,EAAE,aAAF,CAAnB;AACA,aAAKM,MAAL,GAAcN,EAAE,QAAF,CAAd;;AAGA,aAAKO,gBAAL,GAAwB,IAAIC,eAAJ,CAAoBR,EAAE,kBAAF,CAApB,CAAxB;AACA,aAAKS,iBAAL,GAAyB,IAAIC,IAAJ,CACrB,IAAIC,gBAAJ,EADqB,EAErB,KAAKJ,gBAFgB,EAGrB,UAHqB,EAGT,SAHS,CAAzB;;AAMA,aAAKK,aAAL,GAAqB,IAAIC,YAAJ,CAAiBb,EAAE,eAAF,CAAjB,CAArB;AACA,aAAKc,SAAL,GAAiB,IAAIJ,IAAJ,CACb,IAAIK,QAAJ,EADa,EAEb,KAAKH,aAFQ,EAGb,OAHa,CAAjB;AAIH;;;;iCAEQI,K,EAAO;AACZA,kBAAMC,cAAN;;AAEA,gBAAIC,aAAa,KAAKC,eAAL,EAAjB;;AAEA,iBAAKV,iBAAL,CAAuBW,aAAvB,CAAqCF,UAArC;AACA,iBAAKJ,SAAL,CAAeO,QAAf,CAAwB,mCAAxB;;AAEA,iBAAKC,qBAAL,CAA2B,KAAKb,iBAAhC,EAAmD,KAAKK,SAAxD;AACA,iBAAKS,gBAAL;AACH;;;4CAEmB;AAChB,iBAAKd,iBAAL,CAAuBe,iBAAvB;AACA,iBAAKV,SAAL,CAAeO,QAAf,CAAwB,kCAAxB;AACA,iBAAKC,qBAAL,CAA2B,KAAKb,iBAAhC,EAAmD,KAAKK,SAAxD;AACH;;;6CAEoB;AAAA;;AAEjB,gBAAIW,UAAU,IAAIC,iBAAJ,EAAd;;AAEAC,oBAAQC,GAAR,CACI,CAACH,QAAQI,wBAAR,EAAD,EACAJ,QAAQK,iCAAR,EADA,EAEAL,QAAQM,gCAAR,EAFA,CADJ,EAKEC,IALF,CAKO,UAACC,MAAD,EAAY;AACfA,uBAAOC,OAAP,CAAe,0BAAkB;AAC7BC,mCAAeD,OAAf,CAAuB;AAAA,+BACnB,MAAKzB,iBAAL,CAAuBW,aAAvB,CAAqCF,UAArC,CADmB;AAAA,qBAAvB;AAEH,iBAHD;AAIA,sBAAKJ,SAAL,CAAeO,QAAf,CAAwB,oCAAxB;AACA,sBAAKC,qBAAL,CAA2B,MAAKb,iBAAhC,EAAmD,MAAKK,SAAxD;AAEH,aAbD,EAaGsB,KAbH,CAaS,UAACC,IAAD,EAAU;AACf,sBAAKvB,SAAL,CAAeO,QAAf,CAAwBgB,IAAxB;AACA,sBAAKf,qBAAL,CAA2B,MAAKb,iBAAhC,EAAmD,MAAKK,SAAxD;AACA;AACH,aAjBD;;AAmBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCH;;;0CAEiB;AACd,mBAAO,IAAIwB,UAAJ,CACHC,WAAWC,mBAAX,CAA+B,KAAKpC,KAAL,CAAWqC,KAA1C,CADG,EAEH,KAAKpC,WAAL,CAAiBoC,KAFd,EAGH,KAAKnC,MAAL,CAAYmC,KAHT,CAAP;AAKH;;;2CAEkB;AACf,iBAAKrC,KAAL,CAAWqC,KAAX,GAAmB,EAAnB;AACA,iBAAKpC,WAAL,CAAiBoC,KAAjB,GAAyB,CAAzB;AACA,iBAAKnC,MAAL,CAAYmC,KAAZ,GAAoB,GAApB;;AAEA,iBAAKrC,KAAL,CAAWsC,KAAX;AACH;;;8CACqBC,gB,EAAkBC,Q,EAAU;AAC9C,iBAAKrC,gBAAL,CAAsBsC,MAAtB,CAA6BF,gBAA7B;AACA,iBAAK/B,aAAL,CAAmBiC,MAAnB,CAA0BD,QAA1B;AACH","file":"NegociacaoController.2.js","sourcesContent":["class NegociacaoController {\n\n    constructor() {\n        let $ = document.querySelector.bind(document);\n        this._data = $('#data');\n        this._quantidade = $('#quantidade');\n        this._valor = $('#valor');\n\n\n        this._negociacoesView = new NegociacoesView($('#negociacoesView'));\n        this._listaNegociacoes = new Bind(\n            new ListaNegociacoes(),\n            this._negociacoesView,\n            'adiciona', 'esvazia');\n\n\n        this._mensagemView = new MensagemView($('#mensagemView'));\n        this._mensagem = new Bind(\n            new Mensagem(),\n            this._mensagemView,\n            'texto');\n    }\n\n    adiciona(event) {\n        event.preventDefault();\n\n        let negociacao = this._criaNegociacao();\n\n        this._listaNegociacoes.addNegociacao(negociacao);\n        this._mensagem.setTexto('Negociação adicionada com sucesso');\n\n        this._updateNegociacaoView(this._listaNegociacoes, this._mensagem);\n        this._limpaFormulario();\n    }\n\n    deletaNegociacoes() {\n        this._listaNegociacoes.deletaNegociacoes();\n        this._mensagem.setTexto('Negociações apagadas com sucesso');\n        this._updateNegociacaoView(this._listaNegociacoes, this._mensagem);\n    }\n\n    importaNegociacoes() {\n\n        let service = new NegociacaoService();\n\n        Promise.all(\n            [service.obterNegociacoesDaSemana(),\n            service.obterNegociacoesDaSemanaRetrasada(),\n            service.obterNegociacoesDaSemanaAnterior()]\n        \n        ).then((result) => {\n            result.forEach(negociacaoList => {\n                negociacaoList.forEach(negociacao =>  \n                    this._listaNegociacoes.addNegociacao(negociacao))\n            })\n            this._mensagem.setTexto('Negociações importadas com sucesso');\n            this._updateNegociacaoView(this._listaNegociacoes, this._mensagem)\n\n        }).catch((erro) => {\n            this._mensagem.setTexto(erro);\n            this._updateNegociacaoView(this._listaNegociacoes, this._mensagem)\n            return;\n        });\n\n        /*\n            service.obterNegociacoesDaSemana()\n                .then((result) => {\n                    result.forEach(negociacao => this._listaNegociacoes.addNegociacao(negociacao))\n                    this._mensagem.setTexto('Negociações importadas com sucesso');\n                    this._updateNegociacaoView(this._listaNegociacoes, this._mensagem)\n                })\n                .catch((erro) => {\n                    this._mensagem.setTexto(erro);\n                    this._updateNegociacaoView(this._listaNegociacoes, this._mensagem)\n                    return;\n                });\n    \n            service.obterNegociacoesDaSemanaRetrasada()\n                .then((result) => {\n                    result.forEach(negociacao => this._listaNegociacoes.addNegociacao(negociacao))\n                    this._mensagem.setTexto('Negociações importadas com sucesso');\n                    this._updateNegociacaoView(this._listaNegociacoes, this._mensagem)\n                })\n                .catch((erro) => {\n                    this._mensagem.setTexto(erro);\n                    this._updateNegociacaoView(this._listaNegociacoes, this._mensagem)\n                    return;\n                });\n    \n            service.obterNegociacoesDaSemanaAnterior()\n                .then((result) => {\n                    result.forEach(negociacao => this._listaNegociacoes.addNegociacao(negociacao))\n                    this._mensagem.setTexto('Negociações importadas com sucesso');\n                    this._updateNegociacaoView(this._listaNegociacoes, this._mensagem)\n                })\n                .catch((erro) => {\n                    this._mensagem.setTexto(erro);\n                    this._updateNegociacaoView(this._listaNegociacoes, this._mensagem)\n                    return;\n                });\n            */\n    }\n\n    _criaNegociacao() {\n        return new Negociacao(\n            DateHelper.convertStringToData(this._data.value),\n            this._quantidade.value,\n            this._valor.value\n        );\n    }\n\n    _limpaFormulario() {\n        this._data.value = '';\n        this._quantidade.value = 1;\n        this._valor.value = 0.0;\n\n        this._data.focus();\n    }\n    _updateNegociacaoView(listaNegociacoes, mensagem) {\n        this._negociacoesView.update(listaNegociacoes);\n        this._mensagemView.update(mensagem);\n    }\n}"]}